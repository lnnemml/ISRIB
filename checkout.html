<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout ‚Äî ISRIB.shop</title>
  <link rel="stylesheet" href="css/styles.css" />
  <meta name="robots" content="noindex" />
  <style>
    /* –õ–µ–≥–∫–∏–π –ª–æ–∫–∞–ª—å–Ω–∏–π —Å—Ç–∏–ª—å, —Å–ø–∏—Ä–∞—î—Ç—å—Å—è –Ω–∞ —Ç–≤–æ—é –±–∞–∑–æ–≤—É —Ç–∏–ø–æ–≥—Ä–∞—Ñ—ñ–∫—É */
    .checkout-wrap { padding: 48px 0; }
    .checkout-grid { display: grid; gap: 24px; grid-template-columns: 1fr; }
    @media (min-width: 960px){ .checkout-grid{ grid-template-columns: 2fr 1fr; } }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:16px; box-shadow: 0 1px 2px rgba(0,0,0,.04); }
    .card h2 { font-size: 22px; margin:0 0 8px; }
    .card .body { padding: 20px; }
    .row { display:grid; gap:12px; grid-template-columns:1fr; }
    @media (min-width:720px){ .row-2{ grid-template-columns:1fr 1fr; } .row-3{ grid-template-columns:1fr 1fr 1fr; } }
    label { font-weight:600; font-size:14px; color:#0f172a; }
    input, select, textarea {
      width:100%; padding:12px 14px; border:1px solid #cbd5e1; border-radius:12px; background:#fff;
      font: inherit;
    }
    textarea{ min-height:110px; resize:vertical; }
    .muted{ color:#475569; font-size:13px; }
    .pill { display:inline-block; padding:4px 10px; border-radius:999px; background:#eff6ff; color:#1e40af; font-weight:700; font-size:12px; }
    .total { font-weight:800; font-size:18px; }
    .btn-primary{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:12px 18px; background:#1e40af; color:#fff; border-radius:12px; border:none; cursor:pointer; font-weight:700;
    }
    .btn-primary:hover{ filter:brightness(0.95); }
    .danger{ color:#dc2626; }
    .success{ color:#059669; }
    .hidden{ display:none !important; }
    .disclaimer{ font-size:12px; color:#475569; line-height:1.5; }
  </style>
</head>
<body>

  <!-- Header (—Ç–≤—ñ–π —Å–ø—ñ–ª—å–Ω–∏–π) -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo">
          <img src="images/logo-dark-trimmed.png" alt="ISRIB.shop Logo" class="logo-image" />
        </a>
        <nav class="nav">
          <a href="products.html">Products</a>
          <a href="about.html">About</a>
          <a href="faq.html">FAQ</a>
          <a href="contact.html">Contact</a>
          <a href="contact.html?inquiry=order" class="cart-btn">üí¨ Contact to Order</a>
        </nav>
      </div>
    </div>
  </header>

  <main class="checkout-wrap">
    <div class="container">
      <h1>Checkout</h1>
      <p class="muted">Fill out the form below. We‚Äôll confirm availability, shipping and payment details via email or messenger.</p>

      <div class="checkout-grid">
        <!-- LEFT: Form -->
        <form id="checkoutForm" class="card" novalidate>
          <div class="body">
            <h2>Order Details</h2>
            <div class="row row-2">
              <div>
                <label for="product">Product<span class="danger">*</span></label>
                <select id="product" name="product" required>
                  <option value="">Select a product‚Ä¶</option>
                  <option>ISRIB A15</option>
                  <option>ISRIB (Original)</option>
                  <option>ZZL-7</option>
                  <option>MPEP Oxalate</option>
                </select>
              </div>
              <div>
                <label for="quantity">Quantity<span class="danger">*</span></label>
                <input id="quantity" name="quantity" type="number" min="1" step="1" required value="1" />
              </div>
            </div>

            <div class="row row-2" style="margin-top:8px">
              <div>
                <label for="packaging">Packaging</label>
                <select id="packaging" name="packaging">
                  <option value="">Select‚Ä¶</option>
                  <option>Powder (vial)</option>
                  <option>Solution</option>
                </select>
              </div>
              <div>
                <label for="purity">Requested purity (optional)</label>
                <select id="purity" name="purity">
                  <option value="">Standard (‚â•98%)</option>
                  <option>‚â•99%</option>
                </select>
              </div>
            </div>

            <hr style="margin:18px 0; border:none; border-top:1px solid #e5e7eb" />

            <h2>Shipping Details</h2>
            <div class="row row-2">
              <div>
                <label for="firstName">First name<span class="danger">*</span></label>
                <input id="firstName" name="firstName" required />
              </div>
              <div>
                <label for="lastName">Last name<span class="danger">*</span></label>
                <input id="lastName" name="lastName" required />
              </div>
            </div>
            <div class="row">
              <div>
                <label for="email">Email<span class="danger">*</span></label>
                <input id="email" name="email" type="email" required />
              </div>
            </div>
            <div class="row row-3">
              <div>
                <label for="country">Country<span class="danger">*</span></label>
                <input id="country" name="country" required />
              </div>
              <div>
                <label for="city">City<span class="danger">*</span></label>
                <input id="city" name="city" required />
              </div>
              <div>
                <label for="postal">Postal code<span class="danger">*</span></label>
                <input id="postal" name="postal" required />
              </div>
            </div>
            <div class="row">
              <div>
                <label for="address">Address<span class="danger">*</span></label>
                <input id="address" name="address" required />
              </div>
            </div>

            <div class="row row-2">
              <div>
                <label for="messenger">Messenger (optional)</label>
                <select id="messenger" name="messenger">
                  <option value="">Select‚Ä¶</option>
                  <option>Telegram</option>
                  <option>Signal</option>
                  <option>WhatsApp</option>
                </select>
              </div>
              <div>
                <label for="handle">Handle / phone (optional)</label>
                <input id="handle" name="handle" placeholder="@username or +380‚Ä¶" />
              </div>
            </div>

            <div class="row">
              <div>
                <label for="notes">Notes (optional)</label>
                <textarea id="notes" name="notes" placeholder="Any specifics on shipping, formulation, timeline‚Ä¶"></textarea>
              </div>
            </div>

            <!-- honeypot -->
            <input type="text" name="_gotcha" class="hidden" aria-hidden="true" tabindex="-1" autocomplete="off"/>

            <div class="row" style="margin-top:4px">
              <label style="display:flex; gap:10px; align-items:flex-start">
                <input type="checkbox" id="researchOnly" required />
                <span class="disclaimer">
                  I confirm the products are ordered strictly for <strong>research use only</strong>. Not for human consumption, clinical, or veterinary use. I agree to the
                  <a href="terms.html">Terms</a>, <a href="privacy.html">Privacy Policy</a>, and <a href="disclaimer.html">Disclaimer</a>.
                </span>
              </label>
            </div>

            <div class="row" style="margin-top:16px">
              <button class="btn-primary" type="submit">Submit Order Request</button>
              <div id="formMsg" class="muted" style="margin-top:8px"></div>
            </div>
          </div>
        </form>

        <!-- RIGHT: Summary / Help -->
        <aside class="card">
          <div class="body">
            <h2>Order Summary</h2>
            <p class="muted">Manual payments only. We‚Äôll confirm price, shipping method and ETA by email.</p>
            <div class="pill">Research Use Only</div>
            <ul class="muted" style="margin-top:12px; line-height:1.8">
              <li>COA available per batch</li>
              <li>Worldwide shipping</li>
              <li>Secure packaging</li>
              <li>Support via Email/Telegram/Signal</li>
            </ul>
            <hr style="margin:18px 0; border:none; border-top:1px solid #e5e7eb" />
            <p class="muted">Questions? <a href="contact.html">Contact us</a> or use the live chat.</p>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <script>
    // ------- CONFIG: choose submission backend -------
    // OPTION A: Formspree (simple, no-code). Put your endpoint below:
    const FORMSPREE_ENDPOINT = ""; // e.g. "https://formspree.io/f/xxxxxyyy"

    // OPTION B: Vercel serverless via /api/checkout (see code below)
    const VERCEL_API = "/api/checkout"; // works if you add the function

    // pick which to use:
    const SUBMIT_MODE = FORMSPREE_ENDPOINT ? "formspree" : "vercel"; // auto-pick

    const form = document.getElementById('checkoutForm');
    const msg = document.getElementById('formMsg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.textContent = "";

      // basic required check
      if (!form.checkValidity()) {
        msg.textContent = "Please fill all required fields.";
        msg.className = "danger";
        return;
      }

      // honeypot
      if (form._gotcha && form._gotcha.value) return;

      const data = Object.fromEntries(new FormData(form).entries());
      data.timestamp = new Date().toISOString();

      // Save for success page
      try { localStorage.setItem("lastOrder", JSON.stringify(data)); } catch {}

      try {
        let ok = false;
        if (SUBMIT_MODE === "formspree") {
          const r = await fetch(FORMSPREE_ENDPOINT, {
            method: "POST",
            headers: { "Accept": "application/json" },
            body: new FormData(form)
          });
          ok = r.ok;
        } else {
          const r = await fetch(VERCEL_API, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
          });
          ok = r.ok;
        }

        if (ok) {
          // simple order id
          const oid = Math.random().toString(36).slice(2,8).toUpperCase();
          window.location.href = `/success.html?order=${oid}`;
        } else {
          msg.textContent = "Submission failed. Please try again or contact us via chat/email.";
          msg.className = "danger";
        }
      } catch (err) {
        msg.textContent = "Network error. Please try again.";
        msg.className = "danger";
      }
    });
  </script>
</body>
</html>
