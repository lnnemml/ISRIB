<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout ‚Äî ISRIB.shop</title>
  <link rel="stylesheet" href="css/styles.css" />
  <meta name="robots" content="noindex" />
  <style>
    /* –õ–µ–≥–∫–∏–π –ª–æ–∫–∞–ª—å–Ω–∏–π —Å—Ç–∏–ª—å, —Å–ø–∏—Ä–∞—î—Ç—å—Å—è –Ω–∞ —Ç–≤–æ—é –±–∞–∑–æ–≤—É —Ç–∏–ø–æ–≥—Ä–∞—Ñ—ñ–∫—É */
    .checkout-wrap { padding: 48px 0; }
    .checkout-grid { display: grid; gap: 24px; grid-template-columns: 1fr; }
    @media (min-width: 960px){ .checkout-grid{ grid-template-columns: 2fr 1fr; } }
    .card { background:#fff; border:1px solid #e5e7eb; border-radius:16px; box-shadow: 0 1px 2px rgba(0,0,0,.04); }
    .card h2 { font-size: 22px; margin:0 0 8px; }
    .card .body { padding: 20px; }
    .row { display:grid; gap:12px; grid-template-columns:1fr; }
    @media (min-width:720px){ .row-2{ grid-template-columns:1fr 1fr; } .row-3{ grid-template-columns:1fr 1fr 1fr; } }
    label { font-weight:600; font-size:14px; color:#0f172a; }
    input, select, textarea {
      width:100%; padding:12px 14px; border:1px solid #cbd5e1; border-radius:12px; background:#fff;
      font: inherit;
    }
    textarea{ min-height:110px; resize:vertical; }
    .muted{ color:#475569; font-size:13px; }
    .pill { display:inline-block; padding:4px 10px; border-radius:999px; background:#eff6ff; color:#1e40af; font-weight:700; font-size:12px; }
    .total { font-weight:800; font-size:18px; }
    .btn-primary{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:12px 18px; background:#1e40af; color:#fff; border-radius:12px; border:none; cursor:pointer; font-weight:700;
    }
    .btn-primary:hover{ filter:brightness(0.95); }
    .danger{ color:#dc2626; }
    .success{ color:#059669; }
    .hidden{ display:none !important; }
    .disclaimer{ font-size:12px; color:#475569; line-height:1.5; }
  </style>
</head>
<body>

  <!-- Header (—Ç–≤—ñ–π —Å–ø—ñ–ª—å–Ω–∏–π) -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo">
          <img src="images/logo-dark-trimmed.png" alt="ISRIB.shop Logo" class="logo-image" />
        </a>
        <nav class="nav">
          <a href="products.html">Products</a>
          <a href="about.html">About</a>
          <a href="faq.html">FAQ</a>
          <a href="contact.html">Contact</a>
          <a href="contact.html?inquiry=order" class="cart-btn">üí¨ Contact to Order</a>
        </nav>
      </div>
    </div>
  </header>

 <section class="page-section">
  <div class="container">
    <h1>Checkout</h1>
    <p>Fill the form below ‚Äî we‚Äôll confirm availability and send payment options.</p>

    <form id="checkout-form" class="checkout-form">
      <!-- Product -->
      <div class="form-group">
        <label for="product">Product</label>
        <select id="product" name="product" required>
          <option value="" disabled selected>Select product</option>
          <option value="ISRIB A15">ISRIB A15</option>
          <option value="ISRIB (Original)">ISRIB (Original)</option>
          <option value="ZZL-7">ZZL-7</option>
          <option value="MPEP Oxalate">MPEP Oxalate</option>
        </select>
      </div>

      <!-- Quantity -->
      <div class="form-group">
        <label for="quantity">Quantity</label>
        <select id="quantity" name="quantity" required>
          <option value="" disabled selected>Select quantity</option>
        </select>
        <div id="quantity-other-wrap" class="form-inline" style="display:none; margin-top:8px;">
          <label for="quantity-other" class="sr-only">Other amount (grams)</label>
          <input id="quantity-other" name="quantity_other" type="number" min="1" step="0.1" placeholder="Enter grams (‚â• 1.0 g)">
        </div>
      </div>

      <!-- Contact -->
      <div class="form-two">
        <div class="form-group">
          <label for="full_name">Full name</label>
          <input id="full_name" name="full_name" type="text" autocomplete="name" required>
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" autocomplete="email" required>
        </div>
      </div>

      <!-- Messenger -->
      <div class="form-group">
        <label>Preferred contact channel</label>
        <div class="radio-row">
          <label><input type="radio" name="channel" value="Email" checked> Email</label>
          <label><input type="radio" name="channel" value="Telegram"> Telegram</label>
          <label><input type="radio" name="channel" value="WhatsApp"> WhatsApp</label>
          <label><input type="radio" name="channel" value="Signal"> Signal</label>
        </div>
        <div class="form-group" id="channel-handle-wrap" style="margin-top:8px; display:none;">
          <label for="channel_handle" id="channel-handle-label">Your handle</label>
          <input id="channel_handle" name="channel_handle" type="text" placeholder="@username or phone">
          <small class="help">No auto-prefixes ‚Äî enter your Telegram @handle or full phone for messengers.</small>
        </div>
      </div>

      <!-- Notes -->
      <div class="form-group">
        <label for="notes">Notes (optional)</label>
        <textarea id="notes" name="notes" rows="3" placeholder="Shipping preferences, lab details, etc."></textarea>
      </div>

      <button type="submit" class="btn btn-primary">Submit order request</button>
      <p id="checkout-status" class="form-status" role="status" aria-live="polite" style="margin-top:10px;"></p>
    </form>
  </div>
</section>


        <!-- RIGHT: Summary / Help -->
        <aside class="card">
          <div class="body">
            <h2>Order Summary</h2>
            <p class="muted">Manual payments only. We‚Äôll confirm price, shipping method and ETA by email.</p>
            <div class="pill">Research Use Only</div>
            <ul class="muted" style="margin-top:12px; line-height:1.8">
              <li>COA available per batch</li>
              <li>Worldwide shipping</li>
              <li>Secure packaging</li>
              <li>Support via Email/Telegram/Signal</li>
            </ul>
            <hr style="margin:18px 0; border:none; border-top:1px solid #e5e7eb" />
            <p class="muted">Questions? <a href="contact.html">Contact us</a> or use the live chat.</p>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <script>
    // ------- CONFIG: choose submission backend -------
    // OPTION A: Formspree (simple, no-code). Put your endpoint below:
    const FORMSPREE_ENDPOINT = ""; // e.g. "https://formspree.io/f/xxxxxyyy"

    // OPTION B: Vercel serverless via /api/checkout (see code below)
    const VERCEL_API = "/api/checkout"; // works if you add the function

    // pick which to use:
    const SUBMIT_MODE = FORMSPREE_ENDPOINT ? "formspree" : "vercel"; // auto-pick

    const form = document.getElementById('checkoutForm');
    const msg = document.getElementById('formMsg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.textContent = "";

      // basic required check
      if (!form.checkValidity()) {
        msg.textContent = "Please fill all required fields.";
        msg.className = "danger";
        return;
      }

      // honeypot
      if (form._gotcha && form._gotcha.value) return;

      const data = Object.fromEntries(new FormData(form).entries());
      data.timestamp = new Date().toISOString();

      // Save for success page
      try { localStorage.setItem("lastOrder", JSON.stringify(data)); } catch {}

      try {
        let ok = false;
        if (SUBMIT_MODE === "formspree") {
          const r = await fetch(FORMSPREE_ENDPOINT, {
            method: "POST",
            headers: { "Accept": "application/json" },
            body: new FormData(form)
          });
          ok = r.ok;
        } else {
          const r = await fetch(VERCEL_API, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
          });
          ok = r.ok;
        }

        if (ok) {
          // simple order id
          const oid = Math.random().toString(36).slice(2,8).toUpperCase();
          window.location.href = `/success.html?order=${oid}`;
        } else {
          msg.textContent = "Submission failed. Please try again or contact us via chat/email.";
          msg.className = "danger";
        }
      } catch (err) {
        msg.textContent = "Network error. Please try again.";
        msg.className = "danger";
      }
    });
  </script>
</body>
</html>
